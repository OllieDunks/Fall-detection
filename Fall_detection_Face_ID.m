function [trainedClassifier, validationAccuracy] = trainClassifier(trainingData)
% [trainedClassifier, validationAccuracy] = trainClassifier(trainingData)
% Returns a trained classifier and its accuracy. This code recreates the
% classification model trained in Classification Learner app. Use the
% generated code to automate training the same model with new data, or to
% learn how to programmatically train models.
%
%  Input:
%      trainingData: A table containing the same predictor and response
%       columns as those imported into the app.
%
%  Output:
%      trainedClassifier: A struct containing the trained classifier. The
%       struct contains various fields with information about the trained
%       classifier.
%
%      trainedClassifier.predictFcn: A function to make predictions on new
%       data.
%
%      validationAccuracy: A double containing the accuracy in percent. In
%       the app, the History list displays this overall accuracy score for
%       each model.
%
% Use the code to train the model with new data. To retrain your
% classifier, call the function from the command line with your original
% data or new data as the input argument trainingData.
%
% For example, to retrain a classifier trained with the original data set
% T, enter:
%   [trainedClassifier, validationAccuracy] = trainClassifier(T)
%
% To make predictions with the returned 'trainedClassifier' on new data T2,
% use
%   yfit = trainedClassifier.predictFcn(T2)
%
% T2 must be a table containing at least the same predictor columns as used
% during training. For details, enter:
%   trainedClassifier.HowToPredict

% Auto-generated by MATLAB on 15-Mar-2022 11:45:06


% Extract predictors and response
% This code processes the data into the right shape for training the
% model.
inputTable = trainingData;
predictorNames = {'imagefeatures11', 'imagefeatures12', 'imagefeatures13', 'imagefeatures14', 'imagefeatures15', 'imagefeatures16', 'imagefeatures17', 'imagefeatures18', 'imagefeatures19', 'imagefeatures110', 'imagefeatures111', 'imagefeatures112', 'imagefeatures113', 'imagefeatures114', 'imagefeatures115', 'imagefeatures116', 'imagefeatures117', 'imagefeatures118', 'imagefeatures119', 'imagefeatures120', 'imagefeatures121', 'imagefeatures122', 'imagefeatures123', 'imagefeatures124', 'imagefeatures125', 'imagefeatures126', 'imagefeatures127', 'imagefeatures128', 'imagefeatures129', 'imagefeatures130', 'imagefeatures131', 'imagefeatures132', 'imagefeatures133', 'imagefeatures134', 'imagefeatures135', 'imagefeatures136', 'imagefeatures137', 'imagefeatures138', 'imagefeatures139', 'imagefeatures140', 'imagefeatures141', 'imagefeatures142', 'imagefeatures143', 'imagefeatures144', 'imagefeatures145', 'imagefeatures146', 'imagefeatures147', 'imagefeatures148', 'imagefeatures149', 'imagefeatures150', 'imagefeatures151', 'imagefeatures152', 'imagefeatures153', 'imagefeatures154', 'imagefeatures155', 'imagefeatures156', 'imagefeatures157', 'imagefeatures158', 'imagefeatures159', 'imagefeatures160', 'imagefeatures161', 'imagefeatures162', 'imagefeatures163', 'imagefeatures164', 'imagefeatures165', 'imagefeatures166', 'imagefeatures167', 'imagefeatures168', 'imagefeatures169', 'imagefeatures170', 'imagefeatures171', 'imagefeatures172', 'imagefeatures173', 'imagefeatures174', 'imagefeatures175', 'imagefeatures176', 'imagefeatures177', 'imagefeatures178', 'imagefeatures179', 'imagefeatures180', 'imagefeatures181', 'imagefeatures182', 'imagefeatures183', 'imagefeatures184', 'imagefeatures185', 'imagefeatures186', 'imagefeatures187', 'imagefeatures188', 'imagefeatures189', 'imagefeatures190', 'imagefeatures191', 'imagefeatures192', 'imagefeatures193', 'imagefeatures194', 'imagefeatures195', 'imagefeatures196', 'imagefeatures197', 'imagefeatures198', 'imagefeatures199', 'imagefeatures1100', 'imagefeatures1101', 'imagefeatures1102', 'imagefeatures1103', 'imagefeatures1104', 'imagefeatures1105', 'imagefeatures1106', 'imagefeatures1107', 'imagefeatures1108', 'imagefeatures1109', 'imagefeatures1110', 'imagefeatures1111', 'imagefeatures1112', 'imagefeatures1113', 'imagefeatures1114', 'imagefeatures1115', 'imagefeatures1116', 'imagefeatures1117', 'imagefeatures1118', 'imagefeatures1119', 'imagefeatures1120', 'imagefeatures1121', 'imagefeatures1122', 'imagefeatures1123', 'imagefeatures1124', 'imagefeatures1125', 'imagefeatures1126', 'imagefeatures1127', 'imagefeatures1128', 'imagefeatures1129', 'imagefeatures1130', 'imagefeatures1131', 'imagefeatures1132', 'imagefeatures1133', 'imagefeatures1134', 'imagefeatures1135', 'imagefeatures1136', 'imagefeatures1137', 'imagefeatures1138', 'imagefeatures1139', 'imagefeatures1140', 'imagefeatures1141', 'imagefeatures1142', 'imagefeatures1143', 'imagefeatures1144', 'imagefeatures1145', 'imagefeatures1146', 'imagefeatures1147', 'imagefeatures1148', 'imagefeatures1149', 'imagefeatures1150', 'imagefeatures1151', 'imagefeatures1152', 'imagefeatures1153', 'imagefeatures1154', 'imagefeatures1155', 'imagefeatures1156', 'imagefeatures1157', 'imagefeatures1158', 'imagefeatures1159', 'imagefeatures1160', 'imagefeatures1161', 'imagefeatures1162', 'imagefeatures1163', 'imagefeatures1164', 'imagefeatures1165', 'imagefeatures1166', 'imagefeatures1167', 'imagefeatures1168', 'imagefeatures1169', 'imagefeatures1170', 'imagefeatures1171', 'imagefeatures1172', 'imagefeatures1173', 'imagefeatures1174', 'imagefeatures1175', 'imagefeatures1176', 'imagefeatures1177', 'imagefeatures1178', 'imagefeatures1179', 'imagefeatures1180', 'imagefeatures1181', 'imagefeatures1182', 'imagefeatures1183', 'imagefeatures1184', 'imagefeatures1185', 'imagefeatures1186', 'imagefeatures1187', 'imagefeatures1188', 'imagefeatures1189', 'imagefeatures1190', 'imagefeatures1191', 'imagefeatures1192', 'imagefeatures1193', 'imagefeatures1194', 'imagefeatures1195', 'imagefeatures1196', 'imagefeatures1197', 'imagefeatures1198', 'imagefeatures1199', 'imagefeatures1200', 'imagefeatures1201', 'imagefeatures1202', 'imagefeatures1203', 'imagefeatures1204', 'imagefeatures1205', 'imagefeatures1206', 'imagefeatures1207', 'imagefeatures1208', 'imagefeatures1209', 'imagefeatures1210', 'imagefeatures1211', 'imagefeatures1212', 'imagefeatures1213', 'imagefeatures1214', 'imagefeatures1215', 'imagefeatures1216', 'imagefeatures1217', 'imagefeatures1218', 'imagefeatures1219', 'imagefeatures1220', 'imagefeatures1221', 'imagefeatures1222', 'imagefeatures1223', 'imagefeatures1224', 'imagefeatures1225', 'imagefeatures1226', 'imagefeatures1227', 'imagefeatures1228', 'imagefeatures1229', 'imagefeatures1230', 'imagefeatures1231', 'imagefeatures1232', 'imagefeatures1233', 'imagefeatures1234', 'imagefeatures1235', 'imagefeatures1236', 'imagefeatures1237', 'imagefeatures1238', 'imagefeatures1239', 'imagefeatures1240', 'imagefeatures1241', 'imagefeatures1242', 'imagefeatures1243', 'imagefeatures1244', 'imagefeatures1245', 'imagefeatures1246', 'imagefeatures1247', 'imagefeatures1248', 'imagefeatures1249', 'imagefeatures1250', 'imagefeatures1251', 'imagefeatures1252', 'imagefeatures1253', 'imagefeatures1254', 'imagefeatures1255', 'imagefeatures1256', 'imagefeatures1257', 'imagefeatures1258', 'imagefeatures1259', 'imagefeatures1260', 'imagefeatures1261', 'imagefeatures1262', 'imagefeatures1263', 'imagefeatures1264', 'imagefeatures1265', 'imagefeatures1266', 'imagefeatures1267', 'imagefeatures1268', 'imagefeatures1269', 'imagefeatures1270', 'imagefeatures1271', 'imagefeatures1272', 'imagefeatures1273', 'imagefeatures1274', 'imagefeatures1275', 'imagefeatures1276', 'imagefeatures1277', 'imagefeatures1278', 'imagefeatures1279', 'imagefeatures1280', 'imagefeatures1281', 'imagefeatures1282', 'imagefeatures1283', 'imagefeatures1284', 'imagefeatures1285', 'imagefeatures1286', 'imagefeatures1287', 'imagefeatures1288', 'imagefeatures1289', 'imagefeatures1290', 'imagefeatures1291', 'imagefeatures1292', 'imagefeatures1293', 'imagefeatures1294', 'imagefeatures1295', 'imagefeatures1296', 'imagefeatures1297', 'imagefeatures1298', 'imagefeatures1299', 'imagefeatures1300', 'imagefeatures1301', 'imagefeatures1302', 'imagefeatures1303', 'imagefeatures1304', 'imagefeatures1305', 'imagefeatures1306', 'imagefeatures1307', 'imagefeatures1308', 'imagefeatures1309', 'imagefeatures1310', 'imagefeatures1311', 'imagefeatures1312', 'imagefeatures1313', 'imagefeatures1314', 'imagefeatures1315', 'imagefeatures1316', 'imagefeatures1317', 'imagefeatures1318', 'imagefeatures1319', 'imagefeatures1320', 'imagefeatures1321', 'imagefeatures1322', 'imagefeatures1323', 'imagefeatures1324', 'imagefeatures1325', 'imagefeatures1326', 'imagefeatures1327', 'imagefeatures1328', 'imagefeatures1329', 'imagefeatures1330', 'imagefeatures1331', 'imagefeatures1332', 'imagefeatures1333', 'imagefeatures1334', 'imagefeatures1335', 'imagefeatures1336', 'imagefeatures1337', 'imagefeatures1338', 'imagefeatures1339', 'imagefeatures1340', 'imagefeatures1341', 'imagefeatures1342', 'imagefeatures1343', 'imagefeatures1344', 'imagefeatures1345', 'imagefeatures1346', 'imagefeatures1347', 'imagefeatures1348', 'imagefeatures1349', 'imagefeatures1350', 'imagefeatures1351', 'imagefeatures1352', 'imagefeatures1353', 'imagefeatures1354', 'imagefeatures1355', 'imagefeatures1356', 'imagefeatures1357', 'imagefeatures1358', 'imagefeatures1359', 'imagefeatures1360', 'imagefeatures1361', 'imagefeatures1362', 'imagefeatures1363', 'imagefeatures1364', 'imagefeatures1365', 'imagefeatures1366', 'imagefeatures1367', 'imagefeatures1368', 'imagefeatures1369', 'imagefeatures1370', 'imagefeatures1371', 'imagefeatures1372', 'imagefeatures1373', 'imagefeatures1374', 'imagefeatures1375', 'imagefeatures1376', 'imagefeatures1377', 'imagefeatures1378', 'imagefeatures1379', 'imagefeatures1380', 'imagefeatures1381', 'imagefeatures1382', 'imagefeatures1383', 'imagefeatures1384', 'imagefeatures1385', 'imagefeatures1386', 'imagefeatures1387', 'imagefeatures1388', 'imagefeatures1389', 'imagefeatures1390', 'imagefeatures1391', 'imagefeatures1392', 'imagefeatures1393', 'imagefeatures1394', 'imagefeatures1395', 'imagefeatures1396', 'imagefeatures1397', 'imagefeatures1398', 'imagefeatures1399', 'imagefeatures1400', 'imagefeatures1401', 'imagefeatures1402', 'imagefeatures1403', 'imagefeatures1404', 'imagefeatures1405', 'imagefeatures1406', 'imagefeatures1407', 'imagefeatures1408', 'imagefeatures1409', 'imagefeatures1410', 'imagefeatures1411', 'imagefeatures1412', 'imagefeatures1413', 'imagefeatures1414', 'imagefeatures1415', 'imagefeatures1416', 'imagefeatures1417', 'imagefeatures1418', 'imagefeatures1419', 'imagefeatures1420', 'imagefeatures1421', 'imagefeatures1422', 'imagefeatures1423', 'imagefeatures1424', 'imagefeatures1425', 'imagefeatures1426', 'imagefeatures1427', 'imagefeatures1428', 'imagefeatures1429', 'imagefeatures1430', 'imagefeatures1431', 'imagefeatures1432', 'imagefeatures1433', 'imagefeatures1434', 'imagefeatures1435', 'imagefeatures1436', 'imagefeatures1437', 'imagefeatures1438', 'imagefeatures1439', 'imagefeatures1440', 'imagefeatures1441', 'imagefeatures1442', 'imagefeatures1443', 'imagefeatures1444', 'imagefeatures1445', 'imagefeatures1446', 'imagefeatures1447', 'imagefeatures1448', 'imagefeatures1449', 'imagefeatures1450', 'imagefeatures1451', 'imagefeatures1452', 'imagefeatures1453', 'imagefeatures1454', 'imagefeatures1455', 'imagefeatures1456', 'imagefeatures1457', 'imagefeatures1458', 'imagefeatures1459', 'imagefeatures1460', 'imagefeatures1461', 'imagefeatures1462', 'imagefeatures1463', 'imagefeatures1464', 'imagefeatures1465', 'imagefeatures1466', 'imagefeatures1467', 'imagefeatures1468', 'imagefeatures1469', 'imagefeatures1470', 'imagefeatures1471', 'imagefeatures1472', 'imagefeatures1473', 'imagefeatures1474', 'imagefeatures1475', 'imagefeatures1476', 'imagefeatures1477', 'imagefeatures1478', 'imagefeatures1479', 'imagefeatures1480', 'imagefeatures1481', 'imagefeatures1482', 'imagefeatures1483', 'imagefeatures1484', 'imagefeatures1485', 'imagefeatures1486', 'imagefeatures1487', 'imagefeatures1488', 'imagefeatures1489', 'imagefeatures1490', 'imagefeatures1491', 'imagefeatures1492', 'imagefeatures1493', 'imagefeatures1494', 'imagefeatures1495', 'imagefeatures1496', 'imagefeatures1497', 'imagefeatures1498', 'imagefeatures1499', 'imagefeatures1500'};
predictors = inputTable(:, predictorNames);
response = inputTable.Labels;
isCategoricalPredictor = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];

% Train a classifier
% This code specifies all the classifier options and trains the classifier.
classificationNeuralNetwork = fitcnet(...
    predictors, ...
    response, ...
    'LayerSizes', 100, ...
    'Activations', 'relu', ...
    'Lambda', 0, ...
    'IterationLimit', 1000, ...
    'Standardize', true, ...
    'ClassNames', categorical({'Ben photos face'; 'Bennie'; 'Liam photos face'; 'Ollie'}));

% Create the result struct with predict function
predictorExtractionFcn = @(t) t(:, predictorNames);
neuralNetworkPredictFcn = @(x) predict(classificationNeuralNetwork, x);
trainedClassifier.predictFcn = @(x) neuralNetworkPredictFcn(predictorExtractionFcn(x));

% Add additional fields to the result struct
trainedClassifier.RequiredVariables = {'imagefeatures11', 'imagefeatures110', 'imagefeatures1100', 'imagefeatures1101', 'imagefeatures1102', 'imagefeatures1103', 'imagefeatures1104', 'imagefeatures1105', 'imagefeatures1106', 'imagefeatures1107', 'imagefeatures1108', 'imagefeatures1109', 'imagefeatures111', 'imagefeatures1110', 'imagefeatures1111', 'imagefeatures1112', 'imagefeatures1113', 'imagefeatures1114', 'imagefeatures1115', 'imagefeatures1116', 'imagefeatures1117', 'imagefeatures1118', 'imagefeatures1119', 'imagefeatures112', 'imagefeatures1120', 'imagefeatures1121', 'imagefeatures1122', 'imagefeatures1123', 'imagefeatures1124', 'imagefeatures1125', 'imagefeatures1126', 'imagefeatures1127', 'imagefeatures1128', 'imagefeatures1129', 'imagefeatures113', 'imagefeatures1130', 'imagefeatures1131', 'imagefeatures1132', 'imagefeatures1133', 'imagefeatures1134', 'imagefeatures1135', 'imagefeatures1136', 'imagefeatures1137', 'imagefeatures1138', 'imagefeatures1139', 'imagefeatures114', 'imagefeatures1140', 'imagefeatures1141', 'imagefeatures1142', 'imagefeatures1143', 'imagefeatures1144', 'imagefeatures1145', 'imagefeatures1146', 'imagefeatures1147', 'imagefeatures1148', 'imagefeatures1149', 'imagefeatures115', 'imagefeatures1150', 'imagefeatures1151', 'imagefeatures1152', 'imagefeatures1153', 'imagefeatures1154', 'imagefeatures1155', 'imagefeatures1156', 'imagefeatures1157', 'imagefeatures1158', 'imagefeatures1159', 'imagefeatures116', 'imagefeatures1160', 'imagefeatures1161', 'imagefeatures1162', 'imagefeatures1163', 'imagefeatures1164', 'imagefeatures1165', 'imagefeatures1166', 'imagefeatures1167', 'imagefeatures1168', 'imagefeatures1169', 'imagefeatures117', 'imagefeatures1170', 'imagefeatures1171', 'imagefeatures1172', 'imagefeatures1173', 'imagefeatures1174', 'imagefeatures1175', 'imagefeatures1176', 'imagefeatures1177', 'imagefeatures1178', 'imagefeatures1179', 'imagefeatures118', 'imagefeatures1180', 'imagefeatures1181', 'imagefeatures1182', 'imagefeatures1183', 'imagefeatures1184', 'imagefeatures1185', 'imagefeatures1186', 'imagefeatures1187', 'imagefeatures1188', 'imagefeatures1189', 'imagefeatures119', 'imagefeatures1190', 'imagefeatures1191', 'imagefeatures1192', 'imagefeatures1193', 'imagefeatures1194', 'imagefeatures1195', 'imagefeatures1196', 'imagefeatures1197', 'imagefeatures1198', 'imagefeatures1199', 'imagefeatures12', 'imagefeatures120', 'imagefeatures1200', 'imagefeatures1201', 'imagefeatures1202', 'imagefeatures1203', 'imagefeatures1204', 'imagefeatures1205', 'imagefeatures1206', 'imagefeatures1207', 'imagefeatures1208', 'imagefeatures1209', 'imagefeatures121', 'imagefeatures1210', 'imagefeatures1211', 'imagefeatures1212', 'imagefeatures1213', 'imagefeatures1214', 'imagefeatures1215', 'imagefeatures1216', 'imagefeatures1217', 'imagefeatures1218', 'imagefeatures1219', 'imagefeatures122', 'imagefeatures1220', 'imagefeatures1221', 'imagefeatures1222', 'imagefeatures1223', 'imagefeatures1224', 'imagefeatures1225', 'imagefeatures1226', 'imagefeatures1227', 'imagefeatures1228', 'imagefeatures1229', 'imagefeatures123', 'imagefeatures1230', 'imagefeatures1231', 'imagefeatures1232', 'imagefeatures1233', 'imagefeatures1234', 'imagefeatures1235', 'imagefeatures1236', 'imagefeatures1237', 'imagefeatures1238', 'imagefeatures1239', 'imagefeatures124', 'imagefeatures1240', 'imagefeatures1241', 'imagefeatures1242', 'imagefeatures1243', 'imagefeatures1244', 'imagefeatures1245', 'imagefeatures1246', 'imagefeatures1247', 'imagefeatures1248', 'imagefeatures1249', 'imagefeatures125', 'imagefeatures1250', 'imagefeatures1251', 'imagefeatures1252', 'imagefeatures1253', 'imagefeatures1254', 'imagefeatures1255', 'imagefeatures1256', 'imagefeatures1257', 'imagefeatures1258', 'imagefeatures1259', 'imagefeatures126', 'imagefeatures1260', 'imagefeatures1261', 'imagefeatures1262', 'imagefeatures1263', 'imagefeatures1264', 'imagefeatures1265', 'imagefeatures1266', 'imagefeatures1267', 'imagefeatures1268', 'imagefeatures1269', 'imagefeatures127', 'imagefeatures1270', 'imagefeatures1271', 'imagefeatures1272', 'imagefeatures1273', 'imagefeatures1274', 'imagefeatures1275', 'imagefeatures1276', 'imagefeatures1277', 'imagefeatures1278', 'imagefeatures1279', 'imagefeatures128', 'imagefeatures1280', 'imagefeatures1281', 'imagefeatures1282', 'imagefeatures1283', 'imagefeatures1284', 'imagefeatures1285', 'imagefeatures1286', 'imagefeatures1287', 'imagefeatures1288', 'imagefeatures1289', 'imagefeatures129', 'imagefeatures1290', 'imagefeatures1291', 'imagefeatures1292', 'imagefeatures1293', 'imagefeatures1294', 'imagefeatures1295', 'imagefeatures1296', 'imagefeatures1297', 'imagefeatures1298', 'imagefeatures1299', 'imagefeatures13', 'imagefeatures130', 'imagefeatures1300', 'imagefeatures1301', 'imagefeatures1302', 'imagefeatures1303', 'imagefeatures1304', 'imagefeatures1305', 'imagefeatures1306', 'imagefeatures1307', 'imagefeatures1308', 'imagefeatures1309', 'imagefeatures131', 'imagefeatures1310', 'imagefeatures1311', 'imagefeatures1312', 'imagefeatures1313', 'imagefeatures1314', 'imagefeatures1315', 'imagefeatures1316', 'imagefeatures1317', 'imagefeatures1318', 'imagefeatures1319', 'imagefeatures132', 'imagefeatures1320', 'imagefeatures1321', 'imagefeatures1322', 'imagefeatures1323', 'imagefeatures1324', 'imagefeatures1325', 'imagefeatures1326', 'imagefeatures1327', 'imagefeatures1328', 'imagefeatures1329', 'imagefeatures133', 'imagefeatures1330', 'imagefeatures1331', 'imagefeatures1332', 'imagefeatures1333', 'imagefeatures1334', 'imagefeatures1335', 'imagefeatures1336', 'imagefeatures1337', 'imagefeatures1338', 'imagefeatures1339', 'imagefeatures134', 'imagefeatures1340', 'imagefeatures1341', 'imagefeatures1342', 'imagefeatures1343', 'imagefeatures1344', 'imagefeatures1345', 'imagefeatures1346', 'imagefeatures1347', 'imagefeatures1348', 'imagefeatures1349', 'imagefeatures135', 'imagefeatures1350', 'imagefeatures1351', 'imagefeatures1352', 'imagefeatures1353', 'imagefeatures1354', 'imagefeatures1355', 'imagefeatures1356', 'imagefeatures1357', 'imagefeatures1358', 'imagefeatures1359', 'imagefeatures136', 'imagefeatures1360', 'imagefeatures1361', 'imagefeatures1362', 'imagefeatures1363', 'imagefeatures1364', 'imagefeatures1365', 'imagefeatures1366', 'imagefeatures1367', 'imagefeatures1368', 'imagefeatures1369', 'imagefeatures137', 'imagefeatures1370', 'imagefeatures1371', 'imagefeatures1372', 'imagefeatures1373', 'imagefeatures1374', 'imagefeatures1375', 'imagefeatures1376', 'imagefeatures1377', 'imagefeatures1378', 'imagefeatures1379', 'imagefeatures138', 'imagefeatures1380', 'imagefeatures1381', 'imagefeatures1382', 'imagefeatures1383', 'imagefeatures1384', 'imagefeatures1385', 'imagefeatures1386', 'imagefeatures1387', 'imagefeatures1388', 'imagefeatures1389', 'imagefeatures139', 'imagefeatures1390', 'imagefeatures1391', 'imagefeatures1392', 'imagefeatures1393', 'imagefeatures1394', 'imagefeatures1395', 'imagefeatures1396', 'imagefeatures1397', 'imagefeatures1398', 'imagefeatures1399', 'imagefeatures14', 'imagefeatures140', 'imagefeatures1400', 'imagefeatures1401', 'imagefeatures1402', 'imagefeatures1403', 'imagefeatures1404', 'imagefeatures1405', 'imagefeatures1406', 'imagefeatures1407', 'imagefeatures1408', 'imagefeatures1409', 'imagefeatures141', 'imagefeatures1410', 'imagefeatures1411', 'imagefeatures1412', 'imagefeatures1413', 'imagefeatures1414', 'imagefeatures1415', 'imagefeatures1416', 'imagefeatures1417', 'imagefeatures1418', 'imagefeatures1419', 'imagefeatures142', 'imagefeatures1420', 'imagefeatures1421', 'imagefeatures1422', 'imagefeatures1423', 'imagefeatures1424', 'imagefeatures1425', 'imagefeatures1426', 'imagefeatures1427', 'imagefeatures1428', 'imagefeatures1429', 'imagefeatures143', 'imagefeatures1430', 'imagefeatures1431', 'imagefeatures1432', 'imagefeatures1433', 'imagefeatures1434', 'imagefeatures1435', 'imagefeatures1436', 'imagefeatures1437', 'imagefeatures1438', 'imagefeatures1439', 'imagefeatures144', 'imagefeatures1440', 'imagefeatures1441', 'imagefeatures1442', 'imagefeatures1443', 'imagefeatures1444', 'imagefeatures1445', 'imagefeatures1446', 'imagefeatures1447', 'imagefeatures1448', 'imagefeatures1449', 'imagefeatures145', 'imagefeatures1450', 'imagefeatures1451', 'imagefeatures1452', 'imagefeatures1453', 'imagefeatures1454', 'imagefeatures1455', 'imagefeatures1456', 'imagefeatures1457', 'imagefeatures1458', 'imagefeatures1459', 'imagefeatures146', 'imagefeatures1460', 'imagefeatures1461', 'imagefeatures1462', 'imagefeatures1463', 'imagefeatures1464', 'imagefeatures1465', 'imagefeatures1466', 'imagefeatures1467', 'imagefeatures1468', 'imagefeatures1469', 'imagefeatures147', 'imagefeatures1470', 'imagefeatures1471', 'imagefeatures1472', 'imagefeatures1473', 'imagefeatures1474', 'imagefeatures1475', 'imagefeatures1476', 'imagefeatures1477', 'imagefeatures1478', 'imagefeatures1479', 'imagefeatures148', 'imagefeatures1480', 'imagefeatures1481', 'imagefeatures1482', 'imagefeatures1483', 'imagefeatures1484', 'imagefeatures1485', 'imagefeatures1486', 'imagefeatures1487', 'imagefeatures1488', 'imagefeatures1489', 'imagefeatures149', 'imagefeatures1490', 'imagefeatures1491', 'imagefeatures1492', 'imagefeatures1493', 'imagefeatures1494', 'imagefeatures1495', 'imagefeatures1496', 'imagefeatures1497', 'imagefeatures1498', 'imagefeatures1499', 'imagefeatures15', 'imagefeatures150', 'imagefeatures1500', 'imagefeatures151', 'imagefeatures152', 'imagefeatures153', 'imagefeatures154', 'imagefeatures155', 'imagefeatures156', 'imagefeatures157', 'imagefeatures158', 'imagefeatures159', 'imagefeatures16', 'imagefeatures160', 'imagefeatures161', 'imagefeatures162', 'imagefeatures163', 'imagefeatures164', 'imagefeatures165', 'imagefeatures166', 'imagefeatures167', 'imagefeatures168', 'imagefeatures169', 'imagefeatures17', 'imagefeatures170', 'imagefeatures171', 'imagefeatures172', 'imagefeatures173', 'imagefeatures174', 'imagefeatures175', 'imagefeatures176', 'imagefeatures177', 'imagefeatures178', 'imagefeatures179', 'imagefeatures18', 'imagefeatures180', 'imagefeatures181', 'imagefeatures182', 'imagefeatures183', 'imagefeatures184', 'imagefeatures185', 'imagefeatures186', 'imagefeatures187', 'imagefeatures188', 'imagefeatures189', 'imagefeatures19', 'imagefeatures190', 'imagefeatures191', 'imagefeatures192', 'imagefeatures193', 'imagefeatures194', 'imagefeatures195', 'imagefeatures196', 'imagefeatures197', 'imagefeatures198', 'imagefeatures199'};
trainedClassifier.ClassificationNeuralNetwork = classificationNeuralNetwork;
trainedClassifier.About = 'This struct is a trained model exported from Classification Learner R2021a.';
trainedClassifier.HowToPredict = sprintf('To make predictions on a new table, T, use: \n  yfit = c.predictFcn(T) \nreplacing ''c'' with the name of the variable that is this struct, e.g. ''trainedModel''. \n \nThe table, T, must contain the variables returned by: \n  c.RequiredVariables \nVariable formats (e.g. matrix/vector, datatype) must match the original training data. \nAdditional variables are ignored. \n \nFor more information, see <a href="matlab:helpview(fullfile(docroot, ''stats'', ''stats.map''), ''appclassification_exportmodeltoworkspace'')">How to predict using an exported model</a>.');

% Extract predictors and response
% This code processes the data into the right shape for training the
% model.
inputTable = trainingData;
predictorNames = {'imagefeatures11', 'imagefeatures12', 'imagefeatures13', 'imagefeatures14', 'imagefeatures15', 'imagefeatures16', 'imagefeatures17', 'imagefeatures18', 'imagefeatures19', 'imagefeatures110', 'imagefeatures111', 'imagefeatures112', 'imagefeatures113', 'imagefeatures114', 'imagefeatures115', 'imagefeatures116', 'imagefeatures117', 'imagefeatures118', 'imagefeatures119', 'imagefeatures120', 'imagefeatures121', 'imagefeatures122', 'imagefeatures123', 'imagefeatures124', 'imagefeatures125', 'imagefeatures126', 'imagefeatures127', 'imagefeatures128', 'imagefeatures129', 'imagefeatures130', 'imagefeatures131', 'imagefeatures132', 'imagefeatures133', 'imagefeatures134', 'imagefeatures135', 'imagefeatures136', 'imagefeatures137', 'imagefeatures138', 'imagefeatures139', 'imagefeatures140', 'imagefeatures141', 'imagefeatures142', 'imagefeatures143', 'imagefeatures144', 'imagefeatures145', 'imagefeatures146', 'imagefeatures147', 'imagefeatures148', 'imagefeatures149', 'imagefeatures150', 'imagefeatures151', 'imagefeatures152', 'imagefeatures153', 'imagefeatures154', 'imagefeatures155', 'imagefeatures156', 'imagefeatures157', 'imagefeatures158', 'imagefeatures159', 'imagefeatures160', 'imagefeatures161', 'imagefeatures162', 'imagefeatures163', 'imagefeatures164', 'imagefeatures165', 'imagefeatures166', 'imagefeatures167', 'imagefeatures168', 'imagefeatures169', 'imagefeatures170', 'imagefeatures171', 'imagefeatures172', 'imagefeatures173', 'imagefeatures174', 'imagefeatures175', 'imagefeatures176', 'imagefeatures177', 'imagefeatures178', 'imagefeatures179', 'imagefeatures180', 'imagefeatures181', 'imagefeatures182', 'imagefeatures183', 'imagefeatures184', 'imagefeatures185', 'imagefeatures186', 'imagefeatures187', 'imagefeatures188', 'imagefeatures189', 'imagefeatures190', 'imagefeatures191', 'imagefeatures192', 'imagefeatures193', 'imagefeatures194', 'imagefeatures195', 'imagefeatures196', 'imagefeatures197', 'imagefeatures198', 'imagefeatures199', 'imagefeatures1100', 'imagefeatures1101', 'imagefeatures1102', 'imagefeatures1103', 'imagefeatures1104', 'imagefeatures1105', 'imagefeatures1106', 'imagefeatures1107', 'imagefeatures1108', 'imagefeatures1109', 'imagefeatures1110', 'imagefeatures1111', 'imagefeatures1112', 'imagefeatures1113', 'imagefeatures1114', 'imagefeatures1115', 'imagefeatures1116', 'imagefeatures1117', 'imagefeatures1118', 'imagefeatures1119', 'imagefeatures1120', 'imagefeatures1121', 'imagefeatures1122', 'imagefeatures1123', 'imagefeatures1124', 'imagefeatures1125', 'imagefeatures1126', 'imagefeatures1127', 'imagefeatures1128', 'imagefeatures1129', 'imagefeatures1130', 'imagefeatures1131', 'imagefeatures1132', 'imagefeatures1133', 'imagefeatures1134', 'imagefeatures1135', 'imagefeatures1136', 'imagefeatures1137', 'imagefeatures1138', 'imagefeatures1139', 'imagefeatures1140', 'imagefeatures1141', 'imagefeatures1142', 'imagefeatures1143', 'imagefeatures1144', 'imagefeatures1145', 'imagefeatures1146', 'imagefeatures1147', 'imagefeatures1148', 'imagefeatures1149', 'imagefeatures1150', 'imagefeatures1151', 'imagefeatures1152', 'imagefeatures1153', 'imagefeatures1154', 'imagefeatures1155', 'imagefeatures1156', 'imagefeatures1157', 'imagefeatures1158', 'imagefeatures1159', 'imagefeatures1160', 'imagefeatures1161', 'imagefeatures1162', 'imagefeatures1163', 'imagefeatures1164', 'imagefeatures1165', 'imagefeatures1166', 'imagefeatures1167', 'imagefeatures1168', 'imagefeatures1169', 'imagefeatures1170', 'imagefeatures1171', 'imagefeatures1172', 'imagefeatures1173', 'imagefeatures1174', 'imagefeatures1175', 'imagefeatures1176', 'imagefeatures1177', 'imagefeatures1178', 'imagefeatures1179', 'imagefeatures1180', 'imagefeatures1181', 'imagefeatures1182', 'imagefeatures1183', 'imagefeatures1184', 'imagefeatures1185', 'imagefeatures1186', 'imagefeatures1187', 'imagefeatures1188', 'imagefeatures1189', 'imagefeatures1190', 'imagefeatures1191', 'imagefeatures1192', 'imagefeatures1193', 'imagefeatures1194', 'imagefeatures1195', 'imagefeatures1196', 'imagefeatures1197', 'imagefeatures1198', 'imagefeatures1199', 'imagefeatures1200', 'imagefeatures1201', 'imagefeatures1202', 'imagefeatures1203', 'imagefeatures1204', 'imagefeatures1205', 'imagefeatures1206', 'imagefeatures1207', 'imagefeatures1208', 'imagefeatures1209', 'imagefeatures1210', 'imagefeatures1211', 'imagefeatures1212', 'imagefeatures1213', 'imagefeatures1214', 'imagefeatures1215', 'imagefeatures1216', 'imagefeatures1217', 'imagefeatures1218', 'imagefeatures1219', 'imagefeatures1220', 'imagefeatures1221', 'imagefeatures1222', 'imagefeatures1223', 'imagefeatures1224', 'imagefeatures1225', 'imagefeatures1226', 'imagefeatures1227', 'imagefeatures1228', 'imagefeatures1229', 'imagefeatures1230', 'imagefeatures1231', 'imagefeatures1232', 'imagefeatures1233', 'imagefeatures1234', 'imagefeatures1235', 'imagefeatures1236', 'imagefeatures1237', 'imagefeatures1238', 'imagefeatures1239', 'imagefeatures1240', 'imagefeatures1241', 'imagefeatures1242', 'imagefeatures1243', 'imagefeatures1244', 'imagefeatures1245', 'imagefeatures1246', 'imagefeatures1247', 'imagefeatures1248', 'imagefeatures1249', 'imagefeatures1250', 'imagefeatures1251', 'imagefeatures1252', 'imagefeatures1253', 'imagefeatures1254', 'imagefeatures1255', 'imagefeatures1256', 'imagefeatures1257', 'imagefeatures1258', 'imagefeatures1259', 'imagefeatures1260', 'imagefeatures1261', 'imagefeatures1262', 'imagefeatures1263', 'imagefeatures1264', 'imagefeatures1265', 'imagefeatures1266', 'imagefeatures1267', 'imagefeatures1268', 'imagefeatures1269', 'imagefeatures1270', 'imagefeatures1271', 'imagefeatures1272', 'imagefeatures1273', 'imagefeatures1274', 'imagefeatures1275', 'imagefeatures1276', 'imagefeatures1277', 'imagefeatures1278', 'imagefeatures1279', 'imagefeatures1280', 'imagefeatures1281', 'imagefeatures1282', 'imagefeatures1283', 'imagefeatures1284', 'imagefeatures1285', 'imagefeatures1286', 'imagefeatures1287', 'imagefeatures1288', 'imagefeatures1289', 'imagefeatures1290', 'imagefeatures1291', 'imagefeatures1292', 'imagefeatures1293', 'imagefeatures1294', 'imagefeatures1295', 'imagefeatures1296', 'imagefeatures1297', 'imagefeatures1298', 'imagefeatures1299', 'imagefeatures1300', 'imagefeatures1301', 'imagefeatures1302', 'imagefeatures1303', 'imagefeatures1304', 'imagefeatures1305', 'imagefeatures1306', 'imagefeatures1307', 'imagefeatures1308', 'imagefeatures1309', 'imagefeatures1310', 'imagefeatures1311', 'imagefeatures1312', 'imagefeatures1313', 'imagefeatures1314', 'imagefeatures1315', 'imagefeatures1316', 'imagefeatures1317', 'imagefeatures1318', 'imagefeatures1319', 'imagefeatures1320', 'imagefeatures1321', 'imagefeatures1322', 'imagefeatures1323', 'imagefeatures1324', 'imagefeatures1325', 'imagefeatures1326', 'imagefeatures1327', 'imagefeatures1328', 'imagefeatures1329', 'imagefeatures1330', 'imagefeatures1331', 'imagefeatures1332', 'imagefeatures1333', 'imagefeatures1334', 'imagefeatures1335', 'imagefeatures1336', 'imagefeatures1337', 'imagefeatures1338', 'imagefeatures1339', 'imagefeatures1340', 'imagefeatures1341', 'imagefeatures1342', 'imagefeatures1343', 'imagefeatures1344', 'imagefeatures1345', 'imagefeatures1346', 'imagefeatures1347', 'imagefeatures1348', 'imagefeatures1349', 'imagefeatures1350', 'imagefeatures1351', 'imagefeatures1352', 'imagefeatures1353', 'imagefeatures1354', 'imagefeatures1355', 'imagefeatures1356', 'imagefeatures1357', 'imagefeatures1358', 'imagefeatures1359', 'imagefeatures1360', 'imagefeatures1361', 'imagefeatures1362', 'imagefeatures1363', 'imagefeatures1364', 'imagefeatures1365', 'imagefeatures1366', 'imagefeatures1367', 'imagefeatures1368', 'imagefeatures1369', 'imagefeatures1370', 'imagefeatures1371', 'imagefeatures1372', 'imagefeatures1373', 'imagefeatures1374', 'imagefeatures1375', 'imagefeatures1376', 'imagefeatures1377', 'imagefeatures1378', 'imagefeatures1379', 'imagefeatures1380', 'imagefeatures1381', 'imagefeatures1382', 'imagefeatures1383', 'imagefeatures1384', 'imagefeatures1385', 'imagefeatures1386', 'imagefeatures1387', 'imagefeatures1388', 'imagefeatures1389', 'imagefeatures1390', 'imagefeatures1391', 'imagefeatures1392', 'imagefeatures1393', 'imagefeatures1394', 'imagefeatures1395', 'imagefeatures1396', 'imagefeatures1397', 'imagefeatures1398', 'imagefeatures1399', 'imagefeatures1400', 'imagefeatures1401', 'imagefeatures1402', 'imagefeatures1403', 'imagefeatures1404', 'imagefeatures1405', 'imagefeatures1406', 'imagefeatures1407', 'imagefeatures1408', 'imagefeatures1409', 'imagefeatures1410', 'imagefeatures1411', 'imagefeatures1412', 'imagefeatures1413', 'imagefeatures1414', 'imagefeatures1415', 'imagefeatures1416', 'imagefeatures1417', 'imagefeatures1418', 'imagefeatures1419', 'imagefeatures1420', 'imagefeatures1421', 'imagefeatures1422', 'imagefeatures1423', 'imagefeatures1424', 'imagefeatures1425', 'imagefeatures1426', 'imagefeatures1427', 'imagefeatures1428', 'imagefeatures1429', 'imagefeatures1430', 'imagefeatures1431', 'imagefeatures1432', 'imagefeatures1433', 'imagefeatures1434', 'imagefeatures1435', 'imagefeatures1436', 'imagefeatures1437', 'imagefeatures1438', 'imagefeatures1439', 'imagefeatures1440', 'imagefeatures1441', 'imagefeatures1442', 'imagefeatures1443', 'imagefeatures1444', 'imagefeatures1445', 'imagefeatures1446', 'imagefeatures1447', 'imagefeatures1448', 'imagefeatures1449', 'imagefeatures1450', 'imagefeatures1451', 'imagefeatures1452', 'imagefeatures1453', 'imagefeatures1454', 'imagefeatures1455', 'imagefeatures1456', 'imagefeatures1457', 'imagefeatures1458', 'imagefeatures1459', 'imagefeatures1460', 'imagefeatures1461', 'imagefeatures1462', 'imagefeatures1463', 'imagefeatures1464', 'imagefeatures1465', 'imagefeatures1466', 'imagefeatures1467', 'imagefeatures1468', 'imagefeatures1469', 'imagefeatures1470', 'imagefeatures1471', 'imagefeatures1472', 'imagefeatures1473', 'imagefeatures1474', 'imagefeatures1475', 'imagefeatures1476', 'imagefeatures1477', 'imagefeatures1478', 'imagefeatures1479', 'imagefeatures1480', 'imagefeatures1481', 'imagefeatures1482', 'imagefeatures1483', 'imagefeatures1484', 'imagefeatures1485', 'imagefeatures1486', 'imagefeatures1487', 'imagefeatures1488', 'imagefeatures1489', 'imagefeatures1490', 'imagefeatures1491', 'imagefeatures1492', 'imagefeatures1493', 'imagefeatures1494', 'imagefeatures1495', 'imagefeatures1496', 'imagefeatures1497', 'imagefeatures1498', 'imagefeatures1499', 'imagefeatures1500'};
predictors = inputTable(:, predictorNames);
response = inputTable.Labels;
isCategoricalPredictor = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];

% Set up holdout validation
cvp = cvpartition(response, 'Holdout', 0.33);
trainingPredictors = predictors(cvp.training, :);
trainingResponse = response(cvp.training, :);
trainingIsCategoricalPredictor = isCategoricalPredictor;

% Train a classifier
% This code specifies all the classifier options and trains the classifier.
classificationNeuralNetwork = fitcnet(...
    trainingPredictors, ...
    trainingResponse, ...
    'LayerSizes', 100, ...
    'Activations', 'relu', ...
    'Lambda', 0, ...
    'IterationLimit', 1000, ...
    'Standardize', true, ...
    'ClassNames', categorical({'Ben photos face'; 'Bennie'; 'Liam photos face'; 'Ollie'}));

% Create the result struct with predict function
neuralNetworkPredictFcn = @(x) predict(classificationNeuralNetwork, x);
validationPredictFcn = @(x) neuralNetworkPredictFcn(x);

% Add additional fields to the result struct


% Compute validation predictions
validationPredictors = predictors(cvp.test, :);
validationResponse = response(cvp.test, :);
[validationPredictions, validationScores] = validationPredictFcn(validationPredictors);

% Compute validation accuracy
correctPredictions = (validationPredictions == validationResponse);
isMissing = ismissing(validationResponse);
correctPredictions = correctPredictions(~isMissing);
validationAccuracy = sum(correctPredictions)/length(correctPredictions);
